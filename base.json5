{
    "$schema": "https://docs.renovatebot.com/renovate-schema.json",
    "extends": [
        'github>UbiqueInnovation/renovate-config-systems:base.json5',
    ],
    "enabledManagers": [
        "ansible",
        "docker-compose",
        "dockerfile",
        "kubernetes",
        "maven",
        "gradle",
        "github-actions",
        "npm",
        "pip_requirements",
        "poetry"
    ],
    "packageRules": [
        // Separate group for Spring Boot and Cloud packages (one group because they have to be compatible versions)
        {
            "matchDatasources": [
                "maven"
            ],
            "matchPackagePrefixes": [
                "org.springframework.boot:spring-boot",
                "org.springframework.cloud:spring-cloud",
                "com.azure.spring:spring-cloud-azure"
            ],
            "groupName": "Spring Boot/Cloud dependencies"
        },
        // These packages are not public, so renovate needs to check the registryUrls below with the credentials at the top
        {
            "matchDatasources": [
                "maven"
            ],
            "matchPackagePrefixes": [
                "ch.ubique",
                "ch.sac.shared:sac",
                "ch.admin.swisstopo.shared:swisstopo",
                "ch.ethz:eth"
            ],
            "groupName": "UB Artifactory dependencies",
            "registryUrls": [
                "https://artifactory.ubique.ch/artifactory/ubique"
            ]
        },
        {
            "matchPackageNames": [
                "com.azure:azure-sdk-bom"
            ],
            "allowedVersions": "1.2.27"
        },
        {
            "matchPackageNames": [
                "edu.ucar:grib"
            ],
            "allowedVersions": "!/^8\\.*$/"
        },
        {
            "matchPackageNames": [
                "io.kubernetes:client-java"
            ],
            "allowedVersions": "!/^\\d+\\.\\d+\\.\\d+-legacy$/"
        },
        // only non-prerelease versions allowed for ch.ubique:uetlib*
        {
            "matchPackageNames": [
                "ch.ubique:uetlib"
            ],
            "allowedVersions": "/^\\d+\\.\\d+\\.\\d+$/"
        },
        // backend-lib should be replaced
        {
            "matchDatasources": [
                "maven"
            ],
            "matchPackageNames": [
                "ch.ubique:backend-jvm-lib"
            ],
            "abandonmentThreshold": "1 year",
            "replacementName": "ch.ubique:uetlib",
            "labels": [
                "dependencies",
                "eol",
                "migration"
            ],
            "groupName": "Replace Backend-Lib with Uetlib"
        }
    ]
}
